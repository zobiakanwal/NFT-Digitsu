{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\objectSpread2.js\").default;\n\nvar _regeneratorRuntime = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\");\n\nvar _asyncToGenerator = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nvar _slicedToArray = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\slicedToArray.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useStore = exports.StoreProvider = exports.StoreContext = void 0;\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar utils_1 = require(\"../utils\");\n\nvar hooks_1 = require(\"../hooks\");\n\nexports.StoreContext = (0, react_1.createContext)(null);\n\nvar StoreProvider = function StoreProvider(_ref) {\n  var children = _ref.children,\n      ownerAddress = _ref.ownerAddress,\n      storeAddress = _ref.storeAddress;\n  var searchParams = (0, hooks_1.useQuerySearch)();\n  var ownerAddressFromQuery = searchParams.get('store');\n  var initOwnerAddress = ownerAddressFromQuery || ownerAddress;\n  var initStoreAddress = !ownerAddressFromQuery ? storeAddress : undefined;\n  var isConfigured = Boolean(initStoreAddress || initOwnerAddress);\n\n  var _ref2 = (0, react_1.useState)({\n    storeAddress: initStoreAddress,\n    isReady: Boolean(!initOwnerAddress || initStoreAddress)\n  }),\n      _ref3 = _slicedToArray(_ref2, 2),\n      store = _ref3[0],\n      setStore = _ref3[1];\n\n  var setStoreForOwner = (0, react_1.useMemo)(function () {\n    return /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(ownerAddress) {\n        var storeAddress;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return (0, utils_1.getStoreID)(ownerAddress);\n\n              case 2:\n                storeAddress = _context.sent;\n                (0, utils_1.setProgramIds)(storeAddress); // fallback\n\n                setStore({\n                  storeAddress: storeAddress,\n                  isReady: true\n                });\n                console.log(\"CUSTOM STORE: \".concat(storeAddress));\n                return _context.abrupt(\"return\", storeAddress);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n  }, []);\n  (0, react_1.useEffect)(function () {\n    console.log(\"STORE_OWNER_ADDRESS: \".concat(initOwnerAddress));\n\n    if (initOwnerAddress && !initStoreAddress) {\n      setStoreForOwner(initOwnerAddress);\n    } else {\n      (0, utils_1.setProgramIds)(initStoreAddress); // fallback\n\n      console.log(\"CUSTOM STORE FROM ENV: \".concat(initStoreAddress));\n    }\n  }, [initOwnerAddress]);\n  return react_1.default.createElement(exports.StoreContext.Provider, {\n    value: _objectSpread(_objectSpread({}, store), {}, {\n      setStoreForOwner: setStoreForOwner,\n      isConfigured: isConfigured\n    })\n  }, children);\n};\n\nexports.StoreProvider = StoreProvider;\n\nvar useStore = function useStore() {\n  return (0, react_1.useContext)(exports.StoreContext);\n};\n\nexports.useStore = useStore;","map":{"version":3,"sources":["../../../src/contexts/store.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,OAAA,GAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AAQA,IAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAaa,OAAA,CAAA,YAAA,GAAe,CAAA,GAAA,OAAA,CAAA,aAAA,EAA2B,IAA3B,CAAf;;AAEN,IAAM,aAAa,GAGrB,SAHQ,aAGR,OAA6C;AAAA,MAA1C,QAA0C,QAA1C,QAA0C;AAAA,MAAhC,YAAgC,QAAhC,YAAgC;AAAA,MAAlB,YAAkB,QAAlB,YAAkB;AAChD,MAAM,YAAY,GAAG,CAAA,GAAA,OAAA,CAAA,cAAA,GAArB;AACA,MAAM,qBAAqB,GAAG,YAAY,CAAC,GAAb,CAAiB,OAAjB,CAA9B;AAEA,MAAM,gBAAgB,GAAG,qBAAqB,IAAI,YAAlD;AACA,MAAM,gBAAgB,GAAG,CAAC,qBAAD,GAAyB,YAAzB,GAAwC,SAAjE;AACA,MAAM,YAAY,GAAG,OAAO,CAAC,gBAAgB,IAAI,gBAArB,CAA5B;;AAEA,cAA0B,CAAA,GAAA,OAAA,CAAA,QAAA,EAExB;AACA,IAAA,YAAY,EAAE,gBADd;AAEA,IAAA,OAAO,EAAE,OAAO,CAAC,CAAC,gBAAD,IAAqB,gBAAtB;AAFhB,GAFwB,CAA1B;AAAA;AAAA,MAAO,KAAP;AAAA,MAAc,QAAd;;AAOA,MAAM,gBAAgB,GAAG,CAAA,GAAA,OAAA,CAAA,OAAA,EACvB;AAAA;AAAA,2EAAM,iBAAO,YAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACuB,CAAA,GAAA,OAAA,CAAA,UAAA,EAAW,YAAX,CADvB;;AAAA;AACE,gBAAA,YADF;AAEJ,iBAAA,GAAA,OAAA,CAAA,aAAA,EAAc,YAAd,EAFI,CAEyB;;AAC7B,gBAAA,QAAQ,CAAC;AAAE,kBAAA,YAAY,EAAZ,YAAF;AAAgB,kBAAA,OAAO,EAAE;AAAzB,iBAAD,CAAR;AACA,gBAAA,OAAO,CAAC,GAAR,yBAA6B,YAA7B;AAJI,iDAKG,YALH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAN;;AAAA;AAAA;AAAA;AAAA;AAAA,GADuB,EAQvB,EARuB,CAAzB;AAWA,GAAA,GAAA,OAAA,CAAA,SAAA,EAAU,YAAK;AACb,IAAA,OAAO,CAAC,GAAR,gCAAoC,gBAApC;;AACA,QAAI,gBAAgB,IAAI,CAAC,gBAAzB,EAA2C;AACzC,MAAA,gBAAgB,CAAC,gBAAD,CAAhB;AACD,KAFD,MAEO;AACL,OAAA,GAAA,OAAA,CAAA,aAAA,EAAc,gBAAd,EADK,CAC4B;;AACjC,MAAA,OAAO,CAAC,GAAR,kCAAsC,gBAAtC;AACD;AACF,GARD,EAQG,CAAC,gBAAD,CARH;AAUA,SACE,OAAA,CAAA,OAAA,CAAA,aAAA,CAAC,OAAA,CAAA,YAAA,CAAa,QAAd,EAAsB;AAAC,IAAA,KAAK,kCAAO,KAAP;AAAc,MAAA,gBAAgB,EAAhB,gBAAd;AAAgC,MAAA,YAAY,EAAZ;AAAhC;AAAN,GAAtB,EACG,QADH,CADF;AAKD,CA5CM;;AAAM,OAAA,CAAA,aAAA,GAAa,aAAb;;AA8CN,IAAM,QAAQ,GAAG,SAAX,QAAW,GAAK;AAC3B,SAAO,CAAA,GAAA,OAAA,CAAA,UAAA,EAAW,OAAA,CAAA,YAAX,CAAP;AACD,CAFM;;AAAM,OAAA,CAAA,QAAA,GAAQ,QAAR","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.useStore = exports.StoreProvider = exports.StoreContext = void 0;\r\nconst react_1 = __importStar(require(\"react\"));\r\nconst utils_1 = require(\"../utils\");\r\nconst hooks_1 = require(\"../hooks\");\r\nexports.StoreContext = (0, react_1.createContext)(null);\r\nconst StoreProvider = ({ children, ownerAddress, storeAddress }) => {\r\n    const searchParams = (0, hooks_1.useQuerySearch)();\r\n    const ownerAddressFromQuery = searchParams.get('store');\r\n    const initOwnerAddress = ownerAddressFromQuery || ownerAddress;\r\n    const initStoreAddress = !ownerAddressFromQuery ? storeAddress : undefined;\r\n    const isConfigured = Boolean(initStoreAddress || initOwnerAddress);\r\n    const [store, setStore] = (0, react_1.useState)({\r\n        storeAddress: initStoreAddress,\r\n        isReady: Boolean(!initOwnerAddress || initStoreAddress),\r\n    });\r\n    const setStoreForOwner = (0, react_1.useMemo)(() => async (ownerAddress) => {\r\n        const storeAddress = await (0, utils_1.getStoreID)(ownerAddress);\r\n        (0, utils_1.setProgramIds)(storeAddress); // fallback\r\n        setStore({ storeAddress, isReady: true });\r\n        console.log(`CUSTOM STORE: ${storeAddress}`);\r\n        return storeAddress;\r\n    }, []);\r\n    (0, react_1.useEffect)(() => {\r\n        console.log(`STORE_OWNER_ADDRESS: ${initOwnerAddress}`);\r\n        if (initOwnerAddress && !initStoreAddress) {\r\n            setStoreForOwner(initOwnerAddress);\r\n        }\r\n        else {\r\n            (0, utils_1.setProgramIds)(initStoreAddress); // fallback\r\n            console.log(`CUSTOM STORE FROM ENV: ${initStoreAddress}`);\r\n        }\r\n    }, [initOwnerAddress]);\r\n    return (react_1.default.createElement(exports.StoreContext.Provider, { value: { ...store, setStoreForOwner, isConfigured } }, children));\r\n};\r\nexports.StoreProvider = StoreProvider;\r\nconst useStore = () => {\r\n    return (0, react_1.useContext)(exports.StoreContext);\r\n};\r\nexports.useStore = useStore;\r\n//# sourceMappingURL=store.js.map"]},"metadata":{},"sourceType":"script"}