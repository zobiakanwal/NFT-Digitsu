{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.approve = exports.ParsedDataLayout = void 0;\n\nvar web3_js_1 = require(\"@solana/web3.js\");\n\nvar spl_token_1 = require(\"@solana/spl-token\");\n\nvar ids_1 = require(\"../utils/ids\");\n\nvar buffer_layout_1 = __importDefault(require(\"buffer-layout\"));\n\nexports.ParsedDataLayout = buffer_layout_1.default.struct([buffer_layout_1.default.blob(32, 'amount'), buffer_layout_1.default.u8('toChain'), buffer_layout_1.default.blob(32, 'sourceAddress'), buffer_layout_1.default.blob(32, 'targetAddress'), buffer_layout_1.default.blob(32, 'assetAddress'), buffer_layout_1.default.u8('assetChain'), buffer_layout_1.default.u8('assetDecimals'), buffer_layout_1.default.seq(buffer_layout_1.default.u8(), 1), buffer_layout_1.default.u32('nonce'), buffer_layout_1.default.blob(1001, 'vaa'), buffer_layout_1.default.seq(buffer_layout_1.default.u8(), 3), buffer_layout_1.default.u32('vaaTime'), buffer_layout_1.default.u32('lockupTime'), buffer_layout_1.default.u8('pokeCounter'), buffer_layout_1.default.blob(32, 'signatureAccount'), buffer_layout_1.default.u8('initialized')]);\n\nfunction approve(instructions, cleanupInstructions, account, owner, amount) {\n  var autoRevoke = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n  var // if delegate is not passed ephemeral transfer authority is used\n  delegate = arguments.length > 6 ? arguments[6] : undefined;\n  var existingTransferAuthority = arguments.length > 7 ? arguments[7] : undefined;\n  var tokenProgram = ids_1.TOKEN_PROGRAM_ID;\n  var transferAuthority = existingTransferAuthority || web3_js_1.Keypair.generate(); //const delegateKey = delegate ?? transferAuthority.publicKey;\n\n  instructions.push(spl_token_1.Token.createApproveInstruction(tokenProgram, account, delegate !== null && delegate !== void 0 ? delegate : transferAuthority.publicKey, owner, [], amount));\n\n  if (autoRevoke) {\n    cleanupInstructions.push(spl_token_1.Token.createRevokeInstruction(tokenProgram, account, owner, []));\n  }\n\n  return transferAuthority;\n}\n\nexports.approve = approve;","map":{"version":3,"sources":["../../../src/models/account.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,IAAA,SAAA,GAAA,OAAA,CAAA,iBAAA,CAAA;;AAOA,IAAA,WAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,cAAA,CAAA;;AACA,IAAA,eAAA,GAAA,eAAA,CAAA,OAAA,CAAA,eAAA,CAAA,CAAA;;AAqBa,OAAA,CAAA,gBAAA,GAAmB,eAAA,CAAA,OAAA,CAAa,MAAb,CAAoB,CAClD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,EAAlB,EAAsB,QAAtB,CADkD,EAElD,eAAA,CAAA,OAAA,CAAa,EAAb,CAAgB,SAAhB,CAFkD,EAGlD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,EAAlB,EAAsB,eAAtB,CAHkD,EAIlD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,EAAlB,EAAsB,eAAtB,CAJkD,EAKlD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,EAAlB,EAAsB,cAAtB,CALkD,EAMlD,eAAA,CAAA,OAAA,CAAa,EAAb,CAAgB,YAAhB,CANkD,EAOlD,eAAA,CAAA,OAAA,CAAa,EAAb,CAAgB,eAAhB,CAPkD,EAQlD,eAAA,CAAA,OAAA,CAAa,GAAb,CAAiB,eAAA,CAAA,OAAA,CAAa,EAAb,EAAjB,EAAoC,CAApC,CARkD,EASlD,eAAA,CAAA,OAAA,CAAa,GAAb,CAAiB,OAAjB,CATkD,EAUlD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,IAAlB,EAAwB,KAAxB,CAVkD,EAWlD,eAAA,CAAA,OAAA,CAAa,GAAb,CAAiB,eAAA,CAAA,OAAA,CAAa,EAAb,EAAjB,EAAoC,CAApC,CAXkD,EAYlD,eAAA,CAAA,OAAA,CAAa,GAAb,CAAiB,SAAjB,CAZkD,EAalD,eAAA,CAAA,OAAA,CAAa,GAAb,CAAiB,YAAjB,CAbkD,EAclD,eAAA,CAAA,OAAA,CAAa,EAAb,CAAgB,aAAhB,CAdkD,EAelD,eAAA,CAAA,OAAA,CAAa,IAAb,CAAkB,EAAlB,EAAsB,kBAAtB,CAfkD,EAgBlD,eAAA,CAAA,OAAA,CAAa,EAAb,CAAgB,aAAhB,CAhBkD,CAApB,CAAnB;;AAmBb,SAAgB,OAAhB,CACE,YADF,EAEE,mBAFF,EAGE,OAHF,EAIE,KAJF,EAKE,MALF,EAUqC;AAAA,MAJnC,UAImC,uEAJtB,IAIsB;AAAA,MAFnC;AACA,EAAA,QACmC;AAAA,MAAnC,yBAAmC;AAEnC,MAAM,YAAY,GAAG,KAAA,CAAA,gBAArB;AAEA,MAAM,iBAAiB,GAAG,yBAAyB,IAAI,SAAA,CAAA,OAAA,CAAQ,QAAR,EAAvD,CAJmC,CAKnC;;AAEA,EAAA,YAAY,CAAC,IAAb,CACE,WAAA,CAAA,KAAA,CAAM,wBAAN,CACE,YADF,EAEE,OAFF,EAGE,QAAQ,KAAA,IAAR,IAAA,QAAQ,KAAA,KAAA,CAAR,GAAA,QAAA,GAAY,iBAAiB,CAAC,SAHhC,EAIE,KAJF,EAKE,EALF,EAME,MANF,CADF;;AAWA,MAAI,UAAJ,EAAgB;AACd,IAAA,mBAAmB,CAAC,IAApB,CACE,WAAA,CAAA,KAAA,CAAM,uBAAN,CAA8B,YAA9B,EAA4C,OAA5C,EAAqD,KAArD,EAA4D,EAA5D,CADF;AAGD;;AAED,SAAO,iBAAP;AACD;;AAnCD,OAAA,CAAA,OAAA,GAAA,OAAA","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.approve = exports.ParsedDataLayout = void 0;\r\nconst web3_js_1 = require(\"@solana/web3.js\");\r\nconst spl_token_1 = require(\"@solana/spl-token\");\r\nconst ids_1 = require(\"../utils/ids\");\r\nconst buffer_layout_1 = __importDefault(require(\"buffer-layout\"));\r\nexports.ParsedDataLayout = buffer_layout_1.default.struct([\r\n    buffer_layout_1.default.blob(32, 'amount'),\r\n    buffer_layout_1.default.u8('toChain'),\r\n    buffer_layout_1.default.blob(32, 'sourceAddress'),\r\n    buffer_layout_1.default.blob(32, 'targetAddress'),\r\n    buffer_layout_1.default.blob(32, 'assetAddress'),\r\n    buffer_layout_1.default.u8('assetChain'),\r\n    buffer_layout_1.default.u8('assetDecimals'),\r\n    buffer_layout_1.default.seq(buffer_layout_1.default.u8(), 1),\r\n    buffer_layout_1.default.u32('nonce'),\r\n    buffer_layout_1.default.blob(1001, 'vaa'),\r\n    buffer_layout_1.default.seq(buffer_layout_1.default.u8(), 3),\r\n    buffer_layout_1.default.u32('vaaTime'),\r\n    buffer_layout_1.default.u32('lockupTime'),\r\n    buffer_layout_1.default.u8('pokeCounter'),\r\n    buffer_layout_1.default.blob(32, 'signatureAccount'),\r\n    buffer_layout_1.default.u8('initialized'),\r\n]);\r\nfunction approve(instructions, cleanupInstructions, account, owner, amount, autoRevoke = true, \r\n// if delegate is not passed ephemeral transfer authority is used\r\ndelegate, existingTransferAuthority) {\r\n    const tokenProgram = ids_1.TOKEN_PROGRAM_ID;\r\n    const transferAuthority = existingTransferAuthority || web3_js_1.Keypair.generate();\r\n    //const delegateKey = delegate ?? transferAuthority.publicKey;\r\n    instructions.push(spl_token_1.Token.createApproveInstruction(tokenProgram, account, delegate !== null && delegate !== void 0 ? delegate : transferAuthority.publicKey, owner, [], amount));\r\n    if (autoRevoke) {\r\n        cleanupInstructions.push(spl_token_1.Token.createRevokeInstruction(tokenProgram, account, owner, []));\r\n    }\r\n    return transferAuthority;\r\n}\r\nexports.approve = approve;\r\n//# sourceMappingURL=account.js.map"]},"metadata":{},"sourceType":"script"}