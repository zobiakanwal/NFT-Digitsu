{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\");\n\nvar _asyncToGenerator = require(\"C:\\\\Users\\\\AHSAN PC\\\\Desktop\\\\digitsu\\\\gamp\\\\js\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addVoucherToPack = void 0;\n\nvar web3_js_1 = require(\"@solana/web3.js\");\n\nvar borsh_1 = require(\"borsh\");\n\nvar __1 = require(\"../../..\");\n\nvar utils_1 = require(\"../../../utils\");\n\nvar find_1 = require(\"../find\");\n\nfunction addVoucherToPack(_x) {\n  return _addVoucherToPack.apply(this, arguments);\n}\n\nfunction _addVoucherToPack() {\n  _addVoucherToPack = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var index, packSetKey, authority, mint, tokenAccount, PROGRAM_IDS, value, masterMetadataKey, masterEdition, packVoucher, sourceKey, store, data, keys;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            index = _ref.index, packSetKey = _ref.packSetKey, authority = _ref.authority, mint = _ref.mint, tokenAccount = _ref.tokenAccount;\n            PROGRAM_IDS = (0, utils_1.programIds)();\n            value = new __1.AddVoucherToPackArgs();\n            _context.next = 5;\n            return (0, __1.getMetadata)(mint);\n\n          case 5:\n            masterMetadataKey = _context.sent;\n            _context.next = 8;\n            return (0, __1.getEdition)(mint);\n\n          case 8:\n            masterEdition = _context.sent;\n            _context.next = 11;\n            return (0, find_1.findPackVoucherProgramAddress)(packSetKey, index);\n\n          case 11:\n            packVoucher = _context.sent;\n            sourceKey = tokenAccount.pubkey;\n            store = PROGRAM_IDS.store;\n\n            if (store) {\n              _context.next = 16;\n              break;\n            }\n\n            throw new Error('Store not initialized');\n\n          case 16:\n            data = Buffer.from((0, borsh_1.serialize)(__1.PACKS_SCHEMA, value));\n            keys = [// pack_set\n            {\n              pubkey: (0, utils_1.toPublicKey)(packSetKey),\n              isSigner: false,\n              isWritable: true\n            }, // pack_voucher\n            {\n              pubkey: (0, utils_1.toPublicKey)(packVoucher),\n              isSigner: false,\n              isWritable: true\n            }, // signer authority\n            {\n              pubkey: (0, utils_1.toPublicKey)(authority),\n              isSigner: true,\n              isWritable: true\n            }, // voucher_owner\n            {\n              pubkey: (0, utils_1.toPublicKey)(authority),\n              isSigner: true,\n              isWritable: false\n            }, // master_edition\n            {\n              pubkey: (0, utils_1.toPublicKey)(masterEdition),\n              isSigner: false,\n              isWritable: false\n            }, // master_metadata\n            {\n              pubkey: (0, utils_1.toPublicKey)(masterMetadataKey),\n              isSigner: false,\n              isWritable: false\n            }, // mint\n            {\n              pubkey: (0, utils_1.toPublicKey)(mint),\n              isSigner: false,\n              isWritable: false\n            }, // source\n            {\n              pubkey: (0, utils_1.toPublicKey)(sourceKey),\n              isSigner: false,\n              isWritable: true\n            }, // store\n            {\n              pubkey: (0, utils_1.toPublicKey)(store),\n              isSigner: false,\n              isWritable: false\n            }, // rent\n            {\n              pubkey: (0, utils_1.toPublicKey)(web3_js_1.SYSVAR_RENT_PUBKEY),\n              isSigner: false,\n              isWritable: false\n            }, // system_program\n            {\n              pubkey: web3_js_1.SystemProgram.programId,\n              isSigner: false,\n              isWritable: false\n            }, // spl_token program\n            {\n              pubkey: (0, utils_1.programIds)().token,\n              isSigner: false,\n              isWritable: false\n            }];\n            return _context.abrupt(\"return\", new web3_js_1.TransactionInstruction({\n              keys: keys,\n              programId: (0, utils_1.toPublicKey)(PROGRAM_IDS.pack_create),\n              data: data\n            }));\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _addVoucherToPack.apply(this, arguments);\n}\n\nexports.addVoucherToPack = addVoucherToPack;","map":{"version":3,"sources":["../../../../../src/models/packs/instructions/addVoucherToPack.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.addVoucherToPack = void 0;\r\nconst web3_js_1 = require(\"@solana/web3.js\");\r\nconst borsh_1 = require(\"borsh\");\r\nconst __1 = require(\"../../..\");\r\nconst utils_1 = require(\"../../../utils\");\r\nconst find_1 = require(\"../find\");\r\nasync function addVoucherToPack({ index, packSetKey, authority, mint, tokenAccount, }) {\r\n    const PROGRAM_IDS = (0, utils_1.programIds)();\r\n    const value = new __1.AddVoucherToPackArgs();\r\n    const masterMetadataKey = await (0, __1.getMetadata)(mint);\r\n    const masterEdition = await (0, __1.getEdition)(mint);\r\n    const packVoucher = await (0, find_1.findPackVoucherProgramAddress)(packSetKey, index);\r\n    const { pubkey: sourceKey } = tokenAccount;\r\n    const store = PROGRAM_IDS.store;\r\n    if (!store) {\r\n        throw new Error('Store not initialized');\r\n    }\r\n    const data = Buffer.from((0, borsh_1.serialize)(__1.PACKS_SCHEMA, value));\r\n    const keys = [\r\n        // pack_set\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(packSetKey),\r\n            isSigner: false,\r\n            isWritable: true,\r\n        },\r\n        // pack_voucher\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(packVoucher),\r\n            isSigner: false,\r\n            isWritable: true,\r\n        },\r\n        // signer authority\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(authority),\r\n            isSigner: true,\r\n            isWritable: true,\r\n        },\r\n        // voucher_owner\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(authority),\r\n            isSigner: true,\r\n            isWritable: false,\r\n        },\r\n        // master_edition\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(masterEdition),\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // master_metadata\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(masterMetadataKey),\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // mint\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(mint),\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // source\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(sourceKey),\r\n            isSigner: false,\r\n            isWritable: true,\r\n        },\r\n        // store\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(store),\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // rent\r\n        {\r\n            pubkey: (0, utils_1.toPublicKey)(web3_js_1.SYSVAR_RENT_PUBKEY),\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // system_program\r\n        {\r\n            pubkey: web3_js_1.SystemProgram.programId,\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n        // spl_token program\r\n        {\r\n            pubkey: (0, utils_1.programIds)().token,\r\n            isSigner: false,\r\n            isWritable: false,\r\n        },\r\n    ];\r\n    return new web3_js_1.TransactionInstruction({\r\n        keys,\r\n        programId: (0, utils_1.toPublicKey)(PROGRAM_IDS.pack_create),\r\n        data,\r\n    });\r\n}\r\nexports.addVoucherToPack = addVoucherToPack;\r\n//# sourceMappingURL=addVoucherToPack.js.map"]},"metadata":{},"sourceType":"script"}